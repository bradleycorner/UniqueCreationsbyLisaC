<!DOCTYPE html>
<html lang="en" data-theme="blossom">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unique Creations by Lisa C. | Handmade Jewelry</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Square Web Payments SDK will be loaded dynamically based on environment -->

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['"Playfair Display"', 'serif'],
                        sans: ['"Lato"', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: 'rgb(var(--primary-50) / <alpha-value>)',
                            100: 'rgb(var(--primary-100) / <alpha-value>)',
                            200: 'rgb(var(--primary-200) / <alpha-value>)',
                            300: 'rgb(var(--primary-300) / <alpha-value>)',
                            400: 'rgb(var(--primary-400) / <alpha-value>)',
                            500: 'rgb(var(--primary-500) / <alpha-value>)',
                            600: 'rgb(var(--primary-600) / <alpha-value>)',
                            700: 'rgb(var(--primary-700) / <alpha-value>)',
                            800: 'rgb(var(--primary-800) / <alpha-value>)',
                            900: 'rgb(var(--primary-900) / <alpha-value>)',
                        },
                        secondary: {
                            50: 'rgb(var(--secondary-50) / <alpha-value>)',
                            100: 'rgb(var(--secondary-100) / <alpha-value>)',
                            200: 'rgb(var(--secondary-200) / <alpha-value>)',
                            300: 'rgb(var(--secondary-300) / <alpha-value>)',
                            400: 'rgb(var(--secondary-400) / <alpha-value>)',
                            500: 'rgb(var(--secondary-500) / <alpha-value>)',
                            600: 'rgb(var(--secondary-600) / <alpha-value>)',
                            700: 'rgb(var(--secondary-700) / <alpha-value>)',
                            800: 'rgb(var(--secondary-800) / <alpha-value>)',
                            900: 'rgb(var(--secondary-900) / <alpha-value>)',
                        },
                        neutral: {
                            50: 'rgb(var(--neutral-50) / <alpha-value>)',
                            100: 'rgb(var(--neutral-100) / <alpha-value>)',
                            200: 'rgb(var(--neutral-200) / <alpha-value>)',
                            300: 'rgb(var(--neutral-300) / <alpha-value>)',
                            400: 'rgb(var(--neutral-400) / <alpha-value>)',
                            500: 'rgb(var(--neutral-500) / <alpha-value>)',
                            600: 'rgb(var(--neutral-600) / <alpha-value>)',
                            700: 'rgb(var(--neutral-700) / <alpha-value>)',
                            800: 'rgb(var(--neutral-800) / <alpha-value>)',
                            900: 'rgb(var(--neutral-900) / <alpha-value>)',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- THEME DEFINITIONS --- */

        /* 1. BLOSSOM (Original) - Rose / Leaf / Stone */
        :root[data-theme="blossom"] {
            /* Primary (Rose) */
            --primary-50: 255 241 242;
            --primary-100: 255 228 230;
            --primary-200: 254 205 211;
            --primary-300: 253 164 175;
            --primary-400: 251 113 133;
            --primary-500: 244 63 94;
            --primary-600: 225 29 72;
            --primary-700: 190 18 60;
            --primary-800: 159 18 57;
            --primary-900: 136 19 55;

            /* Secondary (Leaf) */
            --secondary-50: 240 253 244;
            --secondary-100: 220 252 231;
            --secondary-200: 187 247 208;
            --secondary-300: 134 239 172;
            --secondary-400: 74 222 128;
            --secondary-500: 34 197 94;
            --secondary-600: 22 163 74;
            --secondary-700: 21 128 61;
            --secondary-800: 22 101 52;
            --secondary-900: 20 83 45;

            /* Neutral (Stone) */
            --neutral-50: 250 250 249;
            --neutral-100: 245 245 244;
            --neutral-200: 231 229 228;
            --neutral-300: 214 211 209;
            --neutral-400: 168 162 158;
            --neutral-500: 120 113 108;
            --neutral-600: 87 83 78;
            --neutral-700: 68 64 60;
            --neutral-800: 41 37 36;
            --neutral-900: 28 25 23;
        }

        /* 2. OCEAN - Sky / Teal / Slate */
        :root[data-theme="ocean"] {
            /* Primary (Sky Blue) */
            --primary-50: 240 249 255;
            --primary-100: 224 242 254;
            --primary-200: 186 230 253;
            --primary-300: 125 211 252;
            --primary-400: 56 189 248;
            --primary-500: 14 165 233;
            --primary-600: 2 132 199;
            --primary-700: 3 105 161;
            --primary-800: 7 89 133;
            --primary-900: 12 74 110;

            /* Secondary (Teal) */
            --secondary-50: 240 253 250;
            --secondary-100: 204 251 241;
            --secondary-200: 153 246 228;
            --secondary-300: 94 234 212;
            --secondary-400: 45 212 191;
            --secondary-500: 20 184 166;
            --secondary-600: 13 148 136;
            --secondary-700: 15 118 110;
            --secondary-800: 17 94 89;
            --secondary-900: 19 78 74;

            /* Neutral (Slate) */
            --neutral-50: 248 250 252;
            --neutral-100: 241 245 249;
            --neutral-200: 226 232 240;
            --neutral-300: 203 213 225;
            --neutral-400: 148 163 184;
            --neutral-500: 100 116 139;
            --neutral-600: 71 85 105;
            --neutral-700: 51 65 85;
            --neutral-800: 30 41 59;
            --neutral-900: 15 23 42;
        }

        /* 3. LUXURY - Amber / Emerald / Gray */
        :root[data-theme="luxury"] {
            /* Primary (Amber/Gold) */
            --primary-50: 255 251 235;
            --primary-100: 254 243 199;
            --primary-200: 253 230 138;
            --primary-300: 252 211 77;
            --primary-400: 251 191 36;
            --primary-500: 245 158 11;
            --primary-600: 217 119 6;
            --primary-700: 180 83 9;
            --primary-800: 146 64 14;
            --primary-900: 120 53 15;

            /* Secondary (Emerald) */
            --secondary-50: 236 253 245;
            --secondary-100: 209 250 229;
            --secondary-200: 167 243 208;
            --secondary-300: 110 231 183;
            --secondary-400: 52 211 153;
            --secondary-500: 16 185 129;
            --secondary-600: 5 150 105;
            --secondary-700: 4 120 87;
            --secondary-800: 6 95 70;
            --secondary-900: 6 78 59;

            /* Neutral (Gray) */
            --neutral-50: 249 250 251;
            --neutral-100: 243 244 246;
            --neutral-200: 229 231 235;
            --neutral-300: 209 213 219;
            --neutral-400: 156 163 175;
            --neutral-500: 107 114 128;
            --neutral-600: 75 85 99;
            --neutral-700: 55 65 81;
            --neutral-800: 31 41 55;
            --neutral-900: 17 24 39;
        }
    </style>
</head>
<body class="font-sans text-neutral-800 bg-neutral-50 antialiased selection:bg-primary-100 flex flex-col min-h-screen">

    <!-- Notification Toast -->
    <div id="toast" class="fixed top-24 right-5 bg-neutral-900 text-white px-6 py-4 rounded shadow-lg transform translate-x-full transition-transform duration-300 z-50 flex items-center gap-3">
        <i data-lucide="check-circle" class="w-5 h-5 text-secondary-500"></i>
        <span id="toast-message">Item added to cart</span>
    </div>

    <!-- Navigation -->
    <nav class="sticky top-0 z-40 bg-white/95 backdrop-blur-md border-b border-neutral-100 transition-all duration-300 shadow-sm" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-24">
                <!-- Mobile Menu Button -->
                <button class="md:hidden p-2 hover:bg-neutral-50 rounded-full" onclick="toggleMobileMenu()">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>

                <!-- Logo Center -->
                <div class="flex-shrink-0 flex items-center cursor-pointer gap-3" onclick="navigateToPage('home')">
                    <!-- Placeholder for the actual Logo File -->
                    <div class="h-16 w-16 relative rounded-lg overflow-hidden border border-neutral-100 shadow-sm bg-white group">
                         <div class="absolute inset-0 flex items-center justify-center bg-white">
                             <span class="font-serif text-2xl font-bold text-neutral-900">UC</span>
                         </div>
                    </div>
                    
                    <div class="hidden sm:block">
                        <span class="block font-serif text-xl font-bold tracking-tight text-neutral-900 leading-none">
                            Unique Creations
                        </span>
                        <span class="block text-sm text-primary-800 font-normal tracking-widest uppercase mt-1">
                            By Lisa C.
                        </span>
                    </div>
                </div>

                <!-- Desktop Nav -->
                <div class="hidden md:flex space-x-8 items-center">
                    <button onclick="navigateToPage('home')" class="nav-link hover:text-primary-800 transition-colors font-medium text-sm uppercase tracking-wide text-primary-800" data-target="home">Home</button>
                    <button onclick="navigateToPage('shop')" class="nav-link hover:text-primary-800 transition-colors font-medium text-sm uppercase tracking-wide" data-target="shop">Shop</button>
                    <button onclick="navigateToPage('about')" class="nav-link hover:text-primary-800 transition-colors font-medium text-sm uppercase tracking-wide" data-target="about">About</button>
                    <button onclick="navigateToPage('contact')" class="nav-link hover:text-primary-800 transition-colors font-medium text-sm uppercase tracking-wide" data-target="contact">Contact</button>
                </div>

                <!-- Right Side: Theme Switcher & Cart -->
                <div class="flex items-center gap-4">
                    <!-- Theme Dropdown -->
                    <div class="relative group">
                        <button class="p-2 hover:bg-neutral-50 rounded-full transition-colors flex items-center gap-2">
                            <i data-lucide="palette" class="w-5 h-5 text-neutral-600"></i>
                        </button>
                        <!-- Dropdown Wrapper with Padding for Bridge -->
                        <div class="absolute right-0 top-full pt-2 hidden group-hover:block">
                            <div class="w-32 bg-white rounded-md shadow-lg py-1 border border-neutral-100">
                                <button onclick="setTheme('blossom')" class="block w-full text-left px-4 py-2 text-sm text-neutral-700 hover:bg-neutral-50 hover:text-primary-600">Blossom</button>
                                <button onclick="setTheme('ocean')" class="block w-full text-left px-4 py-2 text-sm text-neutral-700 hover:bg-neutral-50 hover:text-primary-600">Ocean</button>
                                <button onclick="setTheme('luxury')" class="block w-full text-left px-4 py-2 text-sm text-neutral-700 hover:bg-neutral-50 hover:text-primary-600">Luxury</button>
                            </div>
                        </div>
                    </div>

                    <!-- Cart Icon -->
                    <button onclick="toggleCart()" class="relative p-2 hover:bg-neutral-50 rounded-full transition-colors group">
                        <i data-lucide="shopping-bag" class="w-6 h-6 text-neutral-700 group-hover:text-primary-800 transition-colors"></i>
                        <span id="cart-count" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/4 -translate-y-1/4 bg-primary-800 rounded-full opacity-0 transition-opacity">0</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu (Hidden by default) -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-b border-neutral-100">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button onclick="mobileNavClick('home')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-primary-50 hover:text-primary-800">Home</button>
                <button onclick="mobileNavClick('shop')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-primary-50 hover:text-primary-800">Shop Collections</button>
                <button onclick="mobileNavClick('about')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-primary-50 hover:text-primary-800">About Lisa</button>
                <button onclick="mobileNavClick('contact')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-primary-50 hover:text-primary-800">Contact</button>
                <div class="border-t border-neutral-100 mt-2 pt-2">
                    <p class="px-3 text-xs text-neutral-400 uppercase tracking-wide mb-1">Theme</p>
                    <div class="flex gap-2 px-3">
                        <button onclick="setTheme('blossom')" class="w-6 h-6 rounded-full bg-rose-500 border border-neutral-200"></button>
                        <button onclick="setTheme('ocean')" class="w-6 h-6 rounded-full bg-sky-500 border border-neutral-200"></button>
                        <button onclick="setTheme('luxury')" class="w-6 h-6 rounded-full bg-amber-500 border border-neutral-200"></button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow">
        
        <!-- PAGE: HOME -->
        <div id="view-home" class="page-view">
            <section class="relative bg-white overflow-hidden">
                <div class="max-w-7xl mx-auto">
                    <div class="relative z-10 pb-8 bg-white sm:pb-16 md:pb-20 lg:max-w-2xl lg:w-full lg:pb-28 xl:pb-32">
                        <main class="mt-10 mx-auto max-w-7xl px-4 sm:mt-12 sm:px-6 md:mt-16 lg:mt-20 lg:px-8 xl:mt-28">
                            <div class="sm:text-center lg:text-left fade-in">
                                <h1 class="text-4xl tracking-tight font-extrabold text-neutral-900 sm:text-5xl md:text-6xl font-serif">
                                    <span class="block xl:inline">Handcrafted with</span>
                                    <span class="block text-primary-800 xl:inline italic">elegance & intention.</span>
                                </h1>
                                <p class="mt-3 text-base text-neutral-500 sm:mt-5 sm:text-lg sm:max-w-xl sm:mx-auto md:mt-5 md:text-xl lg:mx-0">
                                    At Unique Creations by Lisa C, we specialize in crafting exquisite pieces that combine traditional techniques with modern design. Our unique creations showcase the intricate artistry of chainmail, the vibrant colors of beads, and the delicate texture of scale. We use anodized aluminum for many of our designs, which is not only incredibly lightweight but also hypoallergenic and won't rust or tarnish. Discover the perfect piece to add a touch of elegance and sophistication to your wardrobe.
                                </p>
                                <div class="mt-5 sm:mt-8 sm:flex sm:justify-center lg:justify-start gap-4">
                                    <div class="rounded-md shadow">
                                        <button onclick="navigateToPage('shop')" class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-neutral-900 hover:bg-neutral-800 md:py-4 md:text-lg transition-colors">
                                            Shop Collection
                                        </button>
                                    </div>
                                    <div class="mt-3 sm:mt-0 sm:ml-3">
                                        <button onclick="navigateToPage('about')" class="w-full flex items-center justify-center px-8 py-3 border border-neutral-200 text-base font-medium rounded-md text-neutral-700 bg-white hover:bg-neutral-50 hover:border-secondary-600 hover:text-secondary-800 md:py-4 md:text-lg transition-all">
                                            Our Story
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </main>
                    </div>
                </div>
                <div class="lg:absolute lg:inset-y-0 lg:right-0 lg:w-1/2 bg-neutral-50">
                    <img class="h-56 w-full object-cover sm:h-72 md:h-96 lg:w-full lg:h-full opacity-90" src="https://images.unsplash.com/photo-1515562141207-7a88fb7ce338?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80" alt="Floral jewelry setting">
                </div>
            </section>
        </div>

        <!-- PAGE: SHOP -->
        <div id="view-shop" class="page-view hidden">
            <section class="py-16 bg-neutral-50 min-h-screen">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-12">
                        <span class="text-primary-800 font-bold tracking-widest uppercase text-xs mb-2 block">Our Catalog</span>
                        <h2 class="text-3xl font-serif font-bold text-neutral-900">Latest Collections</h2>
                        <div class="w-24 h-1 bg-gradient-to-r from-primary-300 to-secondary-300 mx-auto mt-4 rounded-full"></div>
                        
                        <!-- Category Filters -->
                        <div class="mt-8 flex justify-center space-x-2 md:space-x-4 overflow-x-auto pb-2">
                            <button onclick="filterProducts('all')" class="filter-btn active px-6 py-2 rounded-full text-sm font-medium transition-all shadow-sm bg-neutral-900 text-white" data-category="all">All</button>
                            <button onclick="filterProducts('necklaces')" class="filter-btn px-6 py-2 rounded-full text-sm font-medium text-neutral-600 bg-white border border-neutral-200 hover:border-primary-300 hover:text-primary-800 transition-all shadow-sm" data-category="necklaces">Necklaces</button>
                            <button onclick="filterProducts('earrings')" class="filter-btn px-6 py-2 rounded-full text-sm font-medium text-neutral-600 bg-white border border-neutral-200 hover:border-primary-300 hover:text-primary-800 transition-all shadow-sm" data-category="earrings">Earrings</button>
                            <button onclick="filterProducts('bracelets')" class="filter-btn px-6 py-2 rounded-full text-sm font-medium text-neutral-600 bg-white border border-neutral-200 hover:border-primary-300 hover:text-primary-800 transition-all shadow-sm" data-category="bracelets">Bracelets</button>
                        </div>
                    </div>

                    <!-- Product Grid -->
                    <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-10 gap-x-6 xl:gap-x-8">
                        <div class="col-span-full text-center py-20">
                            <i data-lucide="loader-2" class="w-8 h-8 animate-spin mx-auto text-primary-800"></i>
                            <p class="mt-2 text-neutral-500">Loading exquisite pieces...</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- PAGE: ABOUT -->
        <div id="view-about" class="page-view hidden">
            <section class="py-20 bg-white relative overflow-hidden min-h-screen">
                <!-- Decorative bg elements -->
                <div class="absolute top-0 right-0 -mr-20 -mt-20 w-80 h-80 bg-primary-50 rounded-full opacity-50 blur-3xl"></div>
                <div class="absolute bottom-0 left-0 -ml-20 -mb-20 w-80 h-80 bg-secondary-50 rounded-full opacity-50 blur-3xl"></div>

                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                    <div class="lg:grid lg:grid-cols-2 lg:gap-16 items-center">
                        <div class="relative group">
                            <div class="absolute -inset-4 bg-gradient-to-r from-primary-200 to-secondary-200 rounded-lg opacity-30 group-hover:opacity-50 transition duration-500 blur-lg"></div>
                            <div class="relative aspect-w-3 aspect-h-4 rounded-lg overflow-hidden shadow-xl border-4 border-white">
                                <img src="https://images.unsplash.com/photo-1617038260897-41a1f14a8ca0?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80" alt="Jewelry making tools" class="object-cover w-full h-full">
                            </div>
                        </div>
                        <div class="mt-10 lg:mt-0">
                            <h2 class="text-4xl font-serif font-bold text-neutral-900 mb-6">Meet Lisa C.</h2>
                            <div class="prose prose-stone text-neutral-600 text-lg leading-relaxed">
                                <p class="mb-4">
                                    Welcome to Unique Creations. My journey began with a simple love for nature's colors and textures. Just like the lilies in our logo represent rebirth and devotion, I believe every piece of jewelry allows for a reinvention of the self.
                                </p>
                                <p class="mb-4">
                                    What started as a hobby on a small dining table has blossomed into a passion for creating wearable art. Every bead is hand-selected, and every wire is wrapped with intention.
                                </p>
                                <p class="text-neutral-900 font-medium italic">
                                    "Jewelry shouldn't just accessorize an outfitâ€”it should tell your story."
                                </p>
                                <div class="mt-8 flex items-center gap-4">
                                    <span class="font-serif text-2xl text-primary-800">Lisa C.</span>
                                    <div class="h-px bg-neutral-300 flex-1"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- PAGE: CONTACT -->
        <div id="view-contact" class="page-view hidden">
            <section class="bg-neutral-900 text-neutral-300 py-16 min-h-screen">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <h2 class="text-3xl font-serif font-bold text-white mb-12 text-center">Get in Touch</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                        <div>
                            <h3 class="text-2xl font-serif text-white mb-4">Stay Connected</h3>
                            <p class="mb-6">Join our newsletter for early access to new collections and exclusive discounts.</p>
                            <form onsubmit="handleSubscribe(event)" class="flex gap-2">
                                <input type="email" required placeholder="Enter your email" class="flex-1 px-4 py-2 rounded bg-neutral-800 border-none focus:ring-2 focus:ring-primary-500 text-white placeholder-neutral-500">
                                <button type="submit" class="px-6 py-2 bg-secondary-700 text-white rounded hover:bg-secondary-600 transition-colors font-medium">Join</button>
                            </form>
                            <div class="mt-8 flex space-x-6">
                                <a href="#" class="text-neutral-400 hover:text-primary-400 transition-colors"><i data-lucide="instagram"></i></a>
                                <a href="#" class="text-neutral-400 hover:text-primary-400 transition-colors"><i data-lucide="facebook"></i></a>
                                <a href="#" class="text-neutral-400 hover:text-primary-400 transition-colors"><i data-lucide="twitter"></i></a>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-2xl font-serif text-white mb-4">Contact Information</h3>
                            <ul class="space-y-4">
                                <li class="flex items-start">
                                    <i data-lucide="mail" class="w-5 h-5 mr-3 mt-1 text-primary-500"></i>
                                    <span>sales@uniquecreationsbylisac.com</span>
                                </li>
                                <li class="flex items-start">
                                    <i data-lucide="map-pin" class="w-5 h-5 mr-3 mt-1 text-primary-500"></i>
                                    <span>Studio in Jacksonville, Florida<br>Shipping Worldwide</span>
                                </li>
                                <li class="flex flex-col items-start">
                                    <div class="flex items-start mb-2">
                                        <i data-lucide="scan-line" class="w-5 h-5 mr-3 mt-1 text-primary-500"></i>
                                        <span>Find us at local markets! Scan our QR code in person for easy Square payments.</span>
                                    </div>
                                    <!-- QR Code Image Container -->
                                    <div class="ml-8 mt-2 p-3 bg-white rounded-lg inline-block shadow-lg">
                                        <!-- Placeholder QR Code: Replace 'src' below with 'images/your-qr-code.png' -->
                                        <svg class="w-32 h-32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="360" height="360" viewBox="0 0 360 360"><defs><path id="f" fill="black" fill-rule="evenodd" d="M 0 10 a10,10 0 0 1 10,-10 h36 a10,10 0 0 1 10,10 v36 a10,10 0 0 1 -10,10 h-36 a10,10 0 0 1 -10,-10 Z M 8 10 a2,2 0 0 1 2,-2 h36 a2,2 0 0 1 2,2 v36 a2,2 0 0 1 -2,2 h-36 a2,2 0 0 1 -2,-2 Z M 16 18 a2,2 0 0 1 2,-2 h20 a2,2 0 0 1 2,2 v20 a2,2 0 0 1 -2,2 h-20 a2,2 0 0 1 -2,-2 Z" /><path id="s" fill="black" fill-rule="evenodd" d="M 0 9.8 C 0 3.92 3.92 0 9.8 0 L 46.2 0 C 52.08 0 56 3.92 56 9.8 L 56 46.2 C 56 52.08 52.08 56 46.2 56 L 9.8 56 C 3.92 56 0 52.08 0 46.2 Z M 11.2 14 C 11.2 12.32 12.32 11.2 14 11.2 L 42 11.2 C 43.68 11.2 44.8 12.32 44.8 14 L 44.8 42 C 44.8 43.68 43.68 44.8 42 44.8 L 14 44.8 C 12.32 44.8 11.2 43.68 11.2 42 Z M 21 22.4 C 21 21.7 21.7 21 22.4 21 L 33.6 21 C 34.3 21 35 21.7 35 22.4 L 35 33.6 C 35 34.3 34.3 35 33.6 35 L 22.4 35 C 21.7 35 21 34.3 21 33.6 Z" /></defs><rect fill="white" x="0" y="0" width="360" height="360" rx="16" ry="16" /><use xlink:href="#f" x="48" y="48" /><use xlink:href="#f" x="48" y="256" /><use xlink:href="#f" x="256" y="48" /><rect fill="black" x="112" y="48" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M129 52a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h10v-5a3,3 0 0 1 3,-3h32a3,3 0 0 1 3,3v13h13a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-13h-13a3,3 0 0 1 -3,-3v-5h-18v10h5a3,3 0 0 1 3,3v13h5a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-10h-13a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-13zM177 55h-10v10h10v-10zM192 48h8v8h-8zM232 48h8v8h-8zM200 56h8v8h-8zM224 56h8v8h-8zM209 68a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3z" /><path fill="black" d="M233 68a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v13a3,3 0 0 1 -3,3h-5v29a3,3 0 0 1 -3,3h-5v26h18v-5a3,3 0 0 1 3,-3h5v-21a3,3 0 0 1 3,-3h32a3,3 0 0 1 3,3v5h13a3,3 0 0 1 3,3v21h5a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3v-21h-10v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-13h-26v10h5a3,3 0 0 1 3,3v13h21a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-24a3,3 0 0 1 -3,-3v-5h-10v5a3,3 0 0 1 -3,3h-5v13a3,3 0 0 1 -3,3h-13v10h5a3,3 0 0 1 3,3v5h10v-5a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v21h18v-5a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-13a3,3 0 0 1 -3,-3v-5h-18v10h5a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3v5h10v-5a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v13h5a3,3 0 0 1 3,3v5h13a3,3 0 0 1 3,3v13h5a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v10h5a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v13a3,3 0 0 1 -3,3h-13v5a3,3 0 0 1 -3,3h-13v5a3,3 0 0 1 -3,3h-32a3,3 0 0 1 -3,-3v-16a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3v13h18v-5a3,3 0 0 1 3,-3h5v-5a3,3 0 0 1 3,-3h5v-10h-13a3,3 0 0 1 -3,-3v-21h-10v13a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3h-16a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-13a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h10v-18h-21a3,3 0 0 1 -3,-3v-5h-10v10h5a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-10v5a3,3 0 0 1 -3,3h-16a3,3 0 0 1 -3,-3v-8a3,3 0 0 1 3,-3h5v-5a3,3 0 0 1 3,-3h13v-10h-5a3,3 0 0 1 -3,-3v-8a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3v13h13a3,3 0 0 1 3,3v5h10v-10h-5a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h13v-10h-13a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-13a3,3 0 0 1 3,-3h5v-10h-5a3,3 0 0 1 -3,-3v-29h-5a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-26h-13a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-18h-10v13a3,3 0 0 1 -3,3h-5v13a3,3 0 0 1 -3,3h-5v13a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-18v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h13v-5a3,3 0 0 1 3,-3h5v-5a3,3 0 0 1 3,-3h13v-5a3,3 0 0 1 3,-3h5v-21a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h18v-5a3,3 0 0 1 3,-3h5v-5a3,3 0 0 1 3,-3h5v-5zM225 95h-10v10h10v-10zM233 231h-10v10h5a3,3 0 0 1 3,3v5h10v-10h-5a3,3 0 0 1 -3,-3v-5zM273 247h-26v26h26v-26z" /><path fill="black" d="M113 76a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v45h5a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3v-5h-13a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h13v-37z" /><rect fill="black" x="168" y="88" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M129 100a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3v-8z" /><rect fill="black" x="160" y="96" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="176" y="96" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="240" y="96" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M49 116a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-8z" /><rect fill="black" x="80" y="112" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="304" y="112" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M73 124a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-8z" /><path fill="black" d="M89 124a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h13a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3v-5h-10v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-16z" /><path fill="black" d="M233 124a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-8z" /><rect fill="black" x="192" y="128" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M49 140a3,3 0 0 1 3,-3h16a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-16a3,3 0 0 1 -3,-3z" /><rect fill="black" x="128" y="136" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="200" y="136" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M73 148a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3h-5v13a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-16a3,3 0 0 1 3,-3h5v-5z" /><rect fill="black" x="96" y="144" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="88" y="152" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="136" y="152" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M289 156a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3v-8z" /><rect fill="black" x="80" y="160" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="96" y="160" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M249 164a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3v16a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3v-8z" /><rect fill="black" x="272" y="160" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M121 172a3,3 0 0 1 3,-3h16a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-16a3,3 0 0 1 -3,-3z" /><rect fill="black" x="280" y="168" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M49 180a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-8z" /><path fill="black" d="M73 180a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-8z" /><path fill="black" d="M97 180a3,3 0 0 1 3,-3h16a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-16a3,3 0 0 1 -3,-3z" /><rect fill="black" x="272" y="176" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M297 180a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v21h5a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3h-5v21a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-13a3,3 0 0 1 -3,-3v-13h-5a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3v13h10v-34h-10v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-8a3,3 0 0 1 3,-3h13v-5z" /><path fill="black" d="M129 188a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-45v10h13a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-16a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-5a3,3 0 0 1 3,-3h37v-5z" /><rect fill="black" x="64" y="192" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M49 204a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3v-16z" /><path fill="black" d="M121 212a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-5z" /><path fill="black" d="M145 212a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h13a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-10v5a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h13v-13z" /><path fill="black" d="M73 220a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3z" /><rect fill="black" x="264" y="216" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M65 228a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h13a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-5a3,3 0 0 1 -3,-3v-8z" /><path fill="black" d="M97 228a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3h-16a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h13v-10h-5a3,3 0 0 1 -3,-3z" /><path fill="black" d="M49 244a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3z" /><path fill="black" d="M145 244a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3z" /><rect fill="black" x="304" y="240" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M113 252a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h5a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3v-8z" /><rect fill="black" x="288" y="248" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="136" y="256" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="256" y="256" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M297 260a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v16a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-16z" /><rect fill="black" x="152" y="264" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M113 276a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3z" /><path fill="black" d="M137 276a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3v24a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-13h-13a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-5a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v5h10v-10h-5a3,3 0 0 1 -3,-3z" /><path fill="black" d="M169 276a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3z" /><rect fill="black" x="160" y="280" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M185 284a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3v16a3,3 0 0 1 -3,3h-5v5a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-5h-21a3,3 0 0 1 -3,-3a3,3 0 0 1 3,-3h5v-5a3,3 0 0 1 3,3v5h18v-10h-5a3,3 0 0 1 -3,-3z" /><rect fill="black" x="232" y="280" width="8" height="8" rx="2" ry="2" /><path fill="black" d="M289 284a3,3 0 0 1 3,-3a3,3 0 0 1 3,3v8a3,3 0 0 1 -3,3a3,3 0 0 1 -3,-3v-8z" /><path fill="black" d="M113 308a3,3 0 0 1 3,-3h8a3,3 0 0 1 3,3a3,3 0 0 1 -3,3h-8a3,3 0 0 1 -3,-3z" /><rect fill="black" x="152" y="304" width="8" height="8" rx="2" ry="2" /><rect fill="black" x="304" y="304" width="8" height="8" rx="2" ry="2" /><use xlink:href="#s" x="152" y="152" /> 
                                        </svg>
                                        <p class="text-xs text-center text-stone-900 mt-2 font-bold">Scan to Pay</p>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </div>

    </main>

    <!-- Global Footer -->
    <footer class="bg-neutral-900 text-neutral-300 py-8 border-t border-neutral-800 text-center text-sm">
        <p>&copy; 2023 Unique Creations by Lisa C. All rights reserved.</p>
        <p class="mt-2 text-neutral-500">Payments secured by Square</p>
    </footer>

    <!-- Cart Slide-over -->
    <div id="cart-sidebar" class="fixed inset-0 overflow-hidden z-50 pointer-events-none transition-all duration-300">
        <div class="absolute inset-0 overflow-hidden">
            <!-- Background overlay -->
            <div id="cart-overlay" class="absolute inset-0 bg-neutral-900 bg-opacity-75 transition-opacity opacity-0 pointer-events-none" onclick="toggleCart()"></div>

            <div class="pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10">
                <div id="cart-panel" class="pointer-events-auto w-screen max-w-md transform translate-x-full transition-transform duration-300 bg-white shadow-xl flex flex-col h-full">
                    
                    <!-- Cart Header -->
                    <div class="flex items-start justify-between px-4 py-6 sm:px-6 border-b border-neutral-100 bg-neutral-50">
                        <h2 class="text-lg font-medium text-neutral-900 font-serif">Shopping Cart</h2>
                        <button onclick="toggleCart()" class="text-neutral-400 hover:text-neutral-500">
                            <span class="sr-only">Close panel</span>
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>

                    <!-- Cart Items -->
                    <div class="flex-1 overflow-y-auto py-6 px-4 sm:px-6">
                        <div id="cart-items-container" class="space-y-8">
                            <!-- Items injected here -->
                            <div class="text-center text-neutral-500 mt-10">
                                <i data-lucide="shopping-bag" class="w-12 h-12 mx-auto mb-3 opacity-20"></i>
                                <p>Your cart is empty.</p>
                                <button onclick="toggleCart(); navigateToPage('shop')" class="mt-4 text-primary-800 font-medium hover:underline">Start Shopping</button>
                            </div>
                        </div>
                    </div>

                    <!-- Cart Footer -->
                    <div class="border-t border-neutral-100 px-4 py-6 sm:px-6 bg-neutral-50">
                        <div class="flex justify-between text-base font-medium text-neutral-900 mb-4">
                            <p>Subtotal</p>
                            <p id="cart-subtotal">$0.00</p>
                        </div>
                        <p class="mt-0.5 text-sm text-neutral-500 mb-6">Shipping and taxes calculated at checkout.</p>
                        <button onclick="openPaymentModal()" class="w-full flex justify-center items-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-neutral-900 hover:bg-neutral-800 transition-colors">
                            <i data-lucide="lock" class="w-4 h-4 mr-2"></i> Checkout with Square
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Square Payment Modal (Hidden by default) -->
    <div id="payment-modal" class="fixed inset-0 z-50 overflow-y-auto hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <!-- Background overlay -->
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" onclick="closePaymentModal()"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">Secure Payment</h3>
                            <div class="mt-4">
                                <!-- Square Payment Form Placeholder -->
                                <div id="card-container" class="h-48 border border-neutral-200 rounded flex items-center justify-center bg-neutral-50 text-neutral-500">
                                    <!-- This content is replaced by the error or the form -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" onclick="handlePaymentSubmission()" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-neutral-900 text-base font-medium text-white hover:bg-neutral-800 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm">
                        Pay Now
                    </button>
                    <button type="button" onclick="closePaymentModal()" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- API CONFIGURATION ---
        let SQUARE_APP_ID = ''; 
        let LOCATION_ID = '';

        // --- STATE ---
        let cart = [];
        let isCartOpen = false;
        let products = [];
        let payments = null;
        let card = null;

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', async () => {
            lucide.createIcons();
            
            // 1. Fetch Configuration
            await fetchConfig();

            // 2. Initialize Square SDK (if App ID is present)
            if (SQUARE_APP_ID) {
                await initializeSquare();
            } else {
                console.warn("CRITICAL: SQUARE_APP_ID is not set. Payment form will not load. Check Netlify environment variables.");
            }

            // 3. Fetch Inventory and Render
            await fetchCatalog();
            renderProducts('all');
            updateCartUI();

            // Navbar scroll effect
            window.addEventListener('scroll', () => {
                const nav = document.getElementById('navbar');
                if (window.scrollY > 20) {
                    nav.classList.add('shadow-md');
                } else {
                    nav.classList.remove('shadow-md');
                }
            });
        });

        // --- THEME FUNCTIONS ---
        function setTheme(themeName) {
            document.documentElement.setAttribute('data-theme', themeName);
            localStorage.setItem('theme', themeName);
        }

        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            setTheme(savedTheme);
        }

        // --- API & SDK FUNCTIONS ---

        async function fetchConfig() {
            try {
                const response = await fetch('/api/get-square-config');
                if (!response.ok) {
                    console.error(`Failed to fetch config: ${response.status}`);
                    return;
                }
                const config = await response.json();
                SQUARE_APP_ID = config.appId ? config.appId.replace(/["']/g, "").trim() : '';
                LOCATION_ID = config.locationId ? config.locationId.replace(/["']/g, "").trim() : '';
                console.log("Loaded Square Configuration. App ID detected:", SQUARE_APP_ID ? "Yes" : "No");
            } catch (e) {
                console.error("Could not load Square config:", e);
            }
        }

        function loadSquareSdk(appId) {
            const isSandbox = appId.startsWith('sandbox-');
            const scriptUrl = isSandbox
                ? "https://sandbox.web.squarecdn.com/v1/square.js"
                : "https://web.squarecdn.com/v1/square.js";

            return new Promise((resolve, reject) => {
                if (document.querySelector(`script[src="${scriptUrl}"]`)) {
                    return resolve();
                }
                const script = document.createElement('script');
                script.src = scriptUrl;
                script.onload = () => {
                    console.log(`Square SDK loaded from: ${scriptUrl}`);
                    resolve();
                };
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        async function initializeSquare() {
            try {
                await loadSquareSdk(SQUARE_APP_ID);
                if (!window.Square) {
                    throw new Error('Square.js failed to load');
                }
                payments = window.Square.payments(SQUARE_APP_ID, LOCATION_ID);
                console.log("Square SDK Initialized");
            } catch (e) {
                console.error("Square SDK initialization failed:", e);
                payments = null;
            }
        }

        async function fetchCatalog() {
            try {
                const response = await fetch('/api/square-inventory');
                if (!response.ok) throw new Error('API not available');
                const data = await response.json();
                
                if (data.objects) {
                    products = data.objects.map(item => {
                        let category = "all";
                        const nameLower = item.item_data.name.toLowerCase();
                        if (nameLower.includes("necklace")) category = "necklaces";
                        else if (nameLower.includes("earring")) category = "earrings";
                        else if (nameLower.includes("bracelet")) category = "bracelets";

                        return {
                            id: item.id,
                            name: item.item_data.name,
                            price: (item.item_data.variations?.[0]?.item_variation_data?.price_money?.amount || 0) / 100, 
                            category: category, 
                            image: item.image_url,
                            desc: item.item_data.description || "Handcrafted with care."
                        };
                    });
                    console.log("Loaded inventory from Square API.");
                } else {
                    throw new Error("Empty inventory from API");
                }
            } catch (e) {
                console.log("Using Mock Data (Backend not connected or empty):", e);
                products = [
                    { id: 1, name: "Amethyst Teardrop Pendant", price: 45.00, category: "necklaces", image: "https://images.unsplash.com/photo-1599643478518-17488fbbcd75?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80", desc: "Hand-wrapped genuine amethyst." },
                    { id: 2, name: "Rose Quartz Drop Earrings", price: 28.00, category: "earrings", image: "https://images.unsplash.com/photo-1535632066927-ab7c9ab60908?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80", desc: "Delicate pink stones." }
                ];
            }
        }

        // --- PAYMENT FUNCTIONS ---

        async function openPaymentModal() {
            if (cart.length === 0) {
                showToast("Your cart is empty!");
                return;
            }
            
            toggleCart();
            document.getElementById('payment-modal').classList.remove('hidden');
            const cardContainer = document.getElementById('card-container');

            // Always clear the container first
            cardContainer.innerHTML = '';

            if (!payments) {
                console.error("Cannot open payment modal: Square SDK not initialized.");
                cardContainer.innerHTML = `
                    <div class="p-4 text-center">
                        <p class="font-bold text-red-600">Configuration Error</p>
                        <p class="text-sm text-neutral-600 mt-2">
                            The Square Application ID is missing or invalid. Please ensure the
                            <code>SQUARE_APP_ID</code> environment variable is set correctly in your Netlify site settings.
                        </p>
                    </div>`;
                return;
            }

            // If card is already created, it might have been detached. Re-attaching is safe.
            // For simplicity, we'll just re-create it if it's not there.
            if (!card) {
                try {
                    const loader = document.createElement('p');
                    loader.className = 'text-neutral-500 text-sm';
                    loader.textContent = 'Loading secure payment form...';
                    cardContainer.appendChild(loader);

                    card = await payments.card();
                    await card.attach('#card-container');
                } catch (e) {
                    console.error("Failed to attach card form:", e);
                    cardContainer.innerHTML = `<p class="text-red-500 p-4">Error loading Square Payment Form.</p>`;
                }
            } else {
                 // If card object exists, just re-attach it to the container.
                 await card.attach('#card-container');
            }
        }

        function closePaymentModal() {
            document.getElementById('payment-modal').classList.add('hidden');
        }

        async function handlePaymentSubmission() {
            if (!card) {
                alert("Payment system not initialized.");
                return;
            }

            try {
                const result = await card.tokenize();
                if (result.status !== 'OK') {
                    throw new Error(`Tokenization failed: ${result.errors?.[0]?.message || 'Unknown error'}`);
                }

                console.log(`Payment Token Generated: ${result.token}`);
                const totalAmountCents = Math.round(cart.reduce((sum, item) => sum + (item.price * item.quantity), 0) * 100);

                const response = await fetch('/api/payment_methods', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        sourceId: result.token,
                        amount: totalAmountCents,
                        idempotencyKey: crypto.randomUUID()
                    })
                });

                const paymentResult = await response.json();
                if (!response.ok) {
                    throw new Error(paymentResult.error || "Payment was declined.");
                }

                alert(`Payment Complete! Transaction ID: ${paymentResult.payment.id}`);
                closePaymentModal();
                cart = [];
                updateCartUI();

            } catch (e) {
                console.error("Payment Submission Error:", e);
                alert("Payment Failed: " + e.message);
            }
        }

        // --- NAVIGATION & UI FUNCTIONS ---
        
        function navigateToPage(pageId) {
            document.querySelectorAll('.page-view').forEach(el => el.classList.add('hidden'));
            const target = document.getElementById(`view-${pageId}`);
            if (target) target.classList.remove('hidden');
            
            document.querySelectorAll('.nav-link').forEach(btn => {
                btn.classList.toggle('text-primary-800', btn.dataset.target === pageId);
                btn.classList.toggle('text-neutral-800', btn.dataset.target !== pageId);
            });

            window.scrollTo(0, 0);
            document.getElementById('mobile-menu').classList.add('hidden');
        }

        function mobileNavClick(id) {
            navigateToPage(id);
        }

        function renderProducts(category) {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = '';
            const filtered = category === 'all' ? products : products.filter(p => p.category === category);

            if (filtered.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-20"><p class="text-neutral-500">No items found in this category.</p></div>';
                return;
            }

            filtered.forEach((product, index) => {
                const cardEl = document.createElement('div');
                cardEl.className = 'group relative fade-in bg-white rounded-lg shadow-sm hover:shadow-lg transition-shadow duration-300 overflow-hidden border border-neutral-100';
                cardEl.style.animationDelay = `${index * 100}ms`;
                cardEl.innerHTML = `
                    <div class="w-full h-80 bg-neutral-100 overflow-hidden relative">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-full object-center object-cover transform group-hover:scale-105 transition-transform duration-700">
                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-opacity duration-300"></div>
                    </div>
                    <div class="p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-xs text-primary-800 uppercase tracking-wide font-bold mb-1">${product.category}</p>
                                <h3 class="text-lg font-serif text-neutral-900 leading-tight">
                                    <a href="#">
                                        <span aria-hidden="true" class="absolute inset-0"></span>
                                        ${product.name}
                                    </a>
                                </h3>
                            </div>
                            <p class="text-lg font-medium text-neutral-900">$${product.price.toFixed(2)}</p>
                        </div>
                        <p class="mt-2 text-sm text-neutral-500 line-clamp-2">${product.desc}</p>
                        <button onclick="addToCart('${product.id}')" class="mt-4 w-full bg-neutral-900 text-white hover:bg-primary-800 py-3 px-4 rounded transition-colors text-xs font-bold uppercase tracking-widest relative z-20 flex items-center justify-center gap-2">
                           <i data-lucide="plus" class="w-4 h-4"></i> Add to Cart
                        </button>
                    </div>
                `;
                grid.appendChild(cardEl);
            });
            lucide.createIcons();
        }

        function filterProducts(category) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('bg-neutral-900', btn.dataset.category === category);
                btn.classList.toggle('text-white', btn.dataset.category === category);
                btn.classList.toggle('bg-white', btn.dataset.category !== category);
                btn.classList.toggle('text-neutral-600', btn.dataset.category !== category);
            });
            renderProducts(category);
        }

        function addToCart(id) {
            const product = products.find(p => p.id === id);
            const existing = cart.find(item => item.id === id);
            if (existing) {
                existing.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            showToast(`Added ${product.name} to cart`);
            updateCartUI();
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCartUI();
        }

        function updateQuantity(id, change) {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) removeFromCart(id);
                else updateCartUI();
            }
        }

        function updateCartUI() {
            const container = document.getElementById('cart-items-container');
            const countBadge = document.getElementById('cart-count');
            const subtotalEl = document.getElementById('cart-subtotal');
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            countBadge.textContent = totalItems;
            countBadge.classList.toggle('opacity-0', totalItems === 0);
            subtotalEl.textContent = `$${subtotal.toFixed(2)}`;

            if (cart.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-neutral-500 mt-10">
                        <i data-lucide="shopping-bag" class="w-12 h-12 mx-auto mb-3 opacity-20"></i>
                        <p>Your cart is empty.</p>
                        <button onclick="toggleCart(); navigateToPage('shop')" class="mt-4 text-primary-800 font-medium hover:underline">Start Shopping</button>
                    </div>`;
            } else {
                container.innerHTML = cart.map(item => `
                    <div class="flex py-6 border-b border-neutral-100 animate-fadeIn">
                        <div class="h-24 w-24 flex-shrink-0 overflow-hidden rounded-md border border-neutral-200">
                            <img src="${item.image}" alt="${item.name}" class="h-full w-full object-cover object-center">
                        </div>
                        <div class="ml-4 flex flex-1 flex-col">
                            <div>
                                <div class="flex justify-between text-base font-medium text-neutral-900">
                                    <h3 class="font-serif">${item.name}</h3>
                                    <p class="ml-4">$${(item.price * item.quantity).toFixed(2)}</p>
                                </div>
                                <p class="mt-1 text-xs text-neutral-500 uppercase tracking-wide">${item.category}</p>
                            </div>
                            <div class="flex flex-1 items-end justify-between text-sm">
                                <div class="flex items-center border rounded border-neutral-300">
                                    <button onclick="updateQuantity('${item.id}', -1)" class="px-2 py-1 hover:bg-neutral-100 transition-colors">-</button>
                                    <span class="px-2 text-neutral-900 font-medium">${item.quantity}</span>
                                    <button onclick="updateQuantity('${item.id}', 1)" class="px-2 py-1 hover:bg-neutral-100 transition-colors">+</button>
                                </div>
                                <button onclick="removeFromCart('${item.id}')" class="font-medium text-primary-600 hover:text-primary-500 text-xs uppercase tracking-wide">Remove</button>
                            </div>
                        </div>
                    </div>`).join('');
            }
            lucide.createIcons();
        }

        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('cart-overlay');
            const panel = document.getElementById('cart-panel');
            isCartOpen = !isCartOpen;
            sidebar.classList.toggle('pointer-events-none', !isCartOpen);
            overlay.classList.toggle('opacity-0', !isCartOpen);
            panel.classList.toggle('translate-x-full', !isCartOpen);
        }

        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }

        function handleSubscribe(e) {
            e.preventDefault();
            showToast("Thank you for subscribing!");
            e.target.reset();
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').textContent = message;
            toast.classList.remove('translate-x-full');
            setTimeout(() => toast.classList.add('translate-x-full'), 3000);
        }
    </script>
</body>
</html>